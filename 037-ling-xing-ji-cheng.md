#### 菱形继承



<br>
#### 一、菱形继承介绍
**1、什么 是菱形继承? **
**菱形继承就是形如下面这个结构的继承关系**
![](/assets/Snip20190129_2.png)


<br>
**2、菱形继承带来的问题**
- **1> 最底下子类从基类继承的成员变量冗余、重复**
- **2> 最底下子类无法访问基类的成员, 有二义性**

 
<br>
#### 二、菱形继承的具体问题表现如下:
![](/assets/Snip20190201_1.png)
**最终Person基类中的成员会重复, 没有办法访问基类(Person 类)中的成员变量, 因为不论怎样访问都存在二义性**


 
 <br>
#### 三、菱形继承的解决方案 ---- 虚继承

**1、什么是虚继承?**
**所谓虚继承就是在被继承的类前面增加 virtual 关键字修饰父类, 有了这种virtual 关键字修饰的继承我们就称为虚继承, 如下: **
```
class Person {
public:
 int m_age;
};

// 继承时, 使用virtual 关键字修饰父类,称为虚继承
class Student : virtual Public Person{
public:
 int m_score;
};

Student 虚继承自Person
Person 称为Student 的虚基类
```

**2、虚继承的特点**
- **1> B类 虚继承于 A类后, B类对象最前面会增加4个字节(或者8个字节)用于存储虚表**
- **2> 普通继承时,父类的成员变量排在前面子类的成员变量排在后面. 但是虚继承后, 子类的成员变量会排在最前面 虚基类的成员变量排在后面**
- **3> 如果: B类/ C类 都虚继承自A类, D类多继承于B类/ C类, 那么D类在完成继承时, 会将B类/ C类虚继承自A类的重复成员变量去重 **

**3、通过虚继承可以解决菱形继承的中基类成员变量重复与基类成员变量不能访问的问题**


![](/assets/Snip20190201_2.png)
**虚继承后, 原来的基类(Person类), 我们就称它为虚基类**





<br>
#### 四、虚继承,内存结构分析
![](/assets/Snip20190201_5.png)